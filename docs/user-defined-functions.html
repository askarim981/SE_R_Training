<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 User-defined Functions | R training</title>
  <meta name="description" content="Chapter 7 User-defined Functions | R training" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 User-defined Functions | R training" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 User-defined Functions | R training" />
  
  
  

<meta name="author" content="Tom Harris" />


<meta name="date" content="2023-09-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-manipulation.html"/>
<link rel="next" href="graphs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Training</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="Basics.html"><a href="Basics.html"><i class="fa fa-check"></i><b>2</b> Basics of R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Basics.html"><a href="Basics.html#r-and-r-studio"><i class="fa fa-check"></i><b>2.1</b> R and R studio</a></li>
<li class="chapter" data-level="2.2" data-path="Basics.html"><a href="Basics.html#files"><i class="fa fa-check"></i><b>2.2</b> Files</a></li>
<li class="chapter" data-level="2.3" data-path="Basics.html"><a href="Basics.html#Projects"><i class="fa fa-check"></i><b>2.3</b> R Projects</a></li>
<li class="chapter" data-level="2.4" data-path="Basics.html"><a href="Basics.html#r-studios-panes"><i class="fa fa-check"></i><b>2.4</b> R Studio’s Panes</a></li>
<li class="chapter" data-level="2.5" data-path="Basics.html"><a href="Basics.html#packages"><i class="fa fa-check"></i><b>2.5</b> Packages</a></li>
<li class="chapter" data-level="2.6" data-path="Basics.html"><a href="Basics.html#data-types"><i class="fa fa-check"></i><b>2.6</b> Data types</a></li>
<li class="chapter" data-level="2.7" data-path="Basics.html"><a href="Basics.html#data-structures"><i class="fa fa-check"></i><b>2.7</b> Data structures</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="Basics.html"><a href="Basics.html#data-frames"><i class="fa fa-check"></i><b>2.7.1</b> Data Frames</a></li>
<li class="chapter" data-level="2.7.2" data-path="Basics.html"><a href="Basics.html#vectors"><i class="fa fa-check"></i><b>2.7.2</b> Vectors</a></li>
<li class="chapter" data-level="2.7.3" data-path="Basics.html"><a href="Basics.html#factors"><i class="fa fa-check"></i><b>2.7.3</b> Factors</a></li>
<li class="chapter" data-level="2.7.4" data-path="Basics.html"><a href="Basics.html#matrices"><i class="fa fa-check"></i><b>2.7.4</b> Matrices</a></li>
<li class="chapter" data-level="2.7.5" data-path="Basics.html"><a href="Basics.html#lists"><i class="fa fa-check"></i><b>2.7.5</b> Lists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Functions.html"><a href="Functions.html"><i class="fa fa-check"></i><b>3</b> Syntax and Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Functions.html"><a href="Functions.html#syntax"><i class="fa fa-check"></i><b>3.1</b> Syntax</a></li>
<li class="chapter" data-level="3.2" data-path="Functions.html"><a href="Functions.html#baser-functions"><i class="fa fa-check"></i><b>3.2</b> BaseR Functions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Functions.html"><a href="Functions.html#base-r-and-inbuilt-functions"><i class="fa fa-check"></i><b>3.2.1</b> Base R and Inbuilt Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="Functions.html"><a href="Functions.html#programming-functions"><i class="fa fa-check"></i><b>3.2.2</b> Programming functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reading-in-data.html"><a href="reading-in-data.html"><i class="fa fa-check"></i><b>4</b> Reading in Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reading-in-data.html"><a href="reading-in-data.html#good-practice"><i class="fa fa-check"></i><b>4.1</b> Good practice</a></li>
<li class="chapter" data-level="4.2" data-path="reading-in-data.html"><a href="reading-in-data.html#reading-in-.csvs-and-excel-workbooks"><i class="fa fa-check"></i><b>4.2</b> Reading in .csvs and excel workbooks</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reading-in-data.html"><a href="reading-in-data.html#csvs"><i class="fa fa-check"></i><b>4.2.1</b> .csvs</a></li>
<li class="chapter" data-level="4.2.2" data-path="reading-in-data.html"><a href="reading-in-data.html#large-.csvs"><i class="fa fa-check"></i><b>4.2.2</b> Large .csvs</a></li>
<li class="chapter" data-level="4.2.3" data-path="reading-in-data.html"><a href="reading-in-data.html#excel-workbooks"><i class="fa fa-check"></i><b>4.2.3</b> Excel workbooks</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reading-in-data.html"><a href="reading-in-data.html#sql"><i class="fa fa-check"></i><b>4.3</b> SQL</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="reading-in-data.html"><a href="reading-in-data.html#connecting-to-databases"><i class="fa fa-check"></i><b>4.3.1</b> Connecting to databases</a></li>
<li class="chapter" data-level="4.3.2" data-path="reading-in-data.html"><a href="reading-in-data.html#loading-data-into-r"><i class="fa fa-check"></i><b>4.3.2</b> Loading data into R</a></li>
<li class="chapter" data-level="4.3.3" data-path="reading-in-data.html"><a href="reading-in-data.html#running-sql-queries"><i class="fa fa-check"></i><b>4.3.3</b> Running SQL Queries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="creating-outputs.html"><a href="creating-outputs.html"><i class="fa fa-check"></i><b>5</b> Creating outputs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="creating-outputs.html"><a href="creating-outputs.html#writing-.csvs"><i class="fa fa-check"></i><b>5.1</b> Writing <code>.csvs</code></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="creating-outputs.html"><a href="creating-outputs.html#writing-multiple-outputs-as-sheets-of-an-excel-file"><i class="fa fa-check"></i><b>5.1.1</b> Writing multiple outputs as sheets of an excel file</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="creating-outputs.html"><a href="creating-outputs.html#saving-objects"><i class="fa fa-check"></i><b>5.2</b> Saving objects</a></li>
<li class="chapter" data-level="5.3" data-path="creating-outputs.html"><a href="creating-outputs.html#saving-graphs"><i class="fa fa-check"></i><b>5.3</b> Saving graphs</a></li>
<li class="chapter" data-level="5.4" data-path="creating-outputs.html"><a href="creating-outputs.html#r-markdown"><i class="fa fa-check"></i><b>5.4</b> R Markdown</a></li>
<li class="chapter" data-level="5.5" data-path="creating-outputs.html"><a href="creating-outputs.html#presentations"><i class="fa fa-check"></i><b>5.5</b> Presentations</a></li>
<li class="chapter" data-level="5.6" data-path="creating-outputs.html"><a href="creating-outputs.html#other-links"><i class="fa fa-check"></i><b>5.6</b> Other links</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>6</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-manipulation.html"><a href="data-manipulation.html#selecting"><i class="fa fa-check"></i><b>6.1</b> Selecting</a></li>
<li class="chapter" data-level="6.2" data-path="data-manipulation.html"><a href="data-manipulation.html#filtering"><i class="fa fa-check"></i><b>6.2</b> Filtering</a></li>
<li class="chapter" data-level="6.3" data-path="data-manipulation.html"><a href="data-manipulation.html#summarising"><i class="fa fa-check"></i><b>6.3</b> Summarising</a></li>
<li class="chapter" data-level="6.4" data-path="data-manipulation.html"><a href="data-manipulation.html#grouping-by"><i class="fa fa-check"></i><b>6.4</b> Grouping by</a></li>
<li class="chapter" data-level="6.5" data-path="data-manipulation.html"><a href="data-manipulation.html#totals"><i class="fa fa-check"></i><b>6.5</b> Totals</a></li>
<li class="chapter" data-level="6.6" data-path="data-manipulation.html"><a href="data-manipulation.html#mutating"><i class="fa fa-check"></i><b>6.6</b> Mutate</a></li>
<li class="chapter" data-level="6.7" data-path="data-manipulation.html"><a href="data-manipulation.html#pivotting"><i class="fa fa-check"></i><b>6.7</b> Pivotting</a></li>
<li class="chapter" data-level="6.8" data-path="data-manipulation.html"><a href="data-manipulation.html#joining-data"><i class="fa fa-check"></i><b>6.8</b> Joining data</a></li>
<li class="chapter" data-level="6.9" data-path="data-manipulation.html"><a href="data-manipulation.html#extracting_variables"><i class="fa fa-check"></i><b>6.9</b> Extracting variables</a></li>
<li class="chapter" data-level="6.10" data-path="data-manipulation.html"><a href="data-manipulation.html#others"><i class="fa fa-check"></i><b>6.10</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="user-defined-functions.html"><a href="user-defined-functions.html"><i class="fa fa-check"></i><b>7</b> User-defined Functions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="user-defined-functions.html"><a href="user-defined-functions.html#Overview"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="user-defined-functions.html"><a href="user-defined-functions.html#basic-examples"><i class="fa fa-check"></i><b>7.2</b> Basic examples</a></li>
<li class="chapter" data-level="7.3" data-path="user-defined-functions.html"><a href="user-defined-functions.html#returning-objects"><i class="fa fa-check"></i><b>7.3</b> Returning objects</a></li>
<li class="chapter" data-level="7.4" data-path="user-defined-functions.html"><a href="user-defined-functions.html#passing-objects"><i class="fa fa-check"></i><b>7.4</b> Passing objects</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="user-defined-functions.html"><a href="user-defined-functions.html#creating-the-function"><i class="fa fa-check"></i><b>7.4.1</b> Creating the function</a></li>
<li class="chapter" data-level="7.4.2" data-path="user-defined-functions.html"><a href="user-defined-functions.html#passing-data"><i class="fa fa-check"></i><b>7.4.2</b> Passing data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="user-defined-functions.html"><a href="user-defined-functions.html#setting-default-inputs"><i class="fa fa-check"></i><b>7.5</b> Setting default inputs</a></li>
<li class="chapter" data-level="7.6" data-path="user-defined-functions.html"><a href="user-defined-functions.html#Loops"><i class="fa fa-check"></i><b>7.6</b> Using Loops</a></li>
<li class="chapter" data-level="7.7" data-path="user-defined-functions.html"><a href="user-defined-functions.html#random-snippets"><i class="fa fa-check"></i><b>7.7</b> Random snippets</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>8</b> Graphs</a>
<ul>
<li class="chapter" data-level="8.1" data-path="graphs.html"><a href="graphs.html#graphical-resources"><i class="fa fa-check"></i><b>8.1</b> Graphical resources</a></li>
<li class="chapter" data-level="8.2" data-path="graphs.html"><a href="graphs.html#tips"><i class="fa fa-check"></i><b>8.2</b> Tips</a></li>
<li class="chapter" data-level="8.3" data-path="graphs.html"><a href="graphs.html#arranging"><i class="fa fa-check"></i><b>8.3</b> Arranging</a></li>
<li class="chapter" data-level="8.4" data-path="graphs.html"><a href="graphs.html#basic-interactivity"><i class="fa fa-check"></i><b>8.4</b> Basic interactivity</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>9</b> Spatial</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R training</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="user-defined-functions" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> User-defined Functions<a href="user-defined-functions.html#user-defined-functions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The advanced technicalities of User-Defined Functions (UDFs) are, in most instances, outside the scope of this book. If you would like to read more about the specifics covered here, some good resources are:</p>
<ul>
<li><a href="https://adv-r.hadley.nz/quasiquotation.html">Quasiquotation</a></li>
<li><a href="https://dplyr.tidyverse.org/articles/programming.html">Tidy evaluation (data masking and tidy selection)</a></li>
<li><a href="https://www.rdocumentation.org/packages/data.table/versions/1.14.0/topics/%3A%3D">Assignment by reference</a></li>
</ul>
<div id="Overview" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Overview<a href="user-defined-functions.html#Overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter is a quick introduction to UDFs. It also aims to give you some of the tools to overcome specific issues you are likely to encounter as you start to use them more frequently. UDFs give you the power to automate and generalise code. They allow analysts to retain control over function inputs, whilst also minimising the risk of error. User-defined functions are easier to QA and are more readable than large chunks of repeated code.</p>
<p>In general, <strong>a good rule is to write a function if you are going to be using a chunk of code more than twice</strong> (you can also write a function retrospectively if you notice you’ve copied a chunk of code several times).</p>
<p>As with everything in this book, there is no single way to go about writing functions. Do what works for you, and what helps you to achieve the goal you set out.</p>
<p>In order to write a function you need:</p>
<ul>
<li>a name for it;</li>
<li>input parameters;</li>
<li>an operation for the function to perform; and</li>
<li>an output or outputs.</li>
</ul>
</div>
<div id="basic-examples" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Basic examples<a href="user-defined-functions.html#basic-examples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the most basic sense, a function can be used to perform the operation fed to it. In this way you could: firstly, copy and paste any working code into a UD function; save the function; then run the function; and finally observe that the code has been executed.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="user-defined-functions.html#cb74-1" tabindex="-1"></a><span class="co"># Using the existing print() function: </span></span>
<span id="cb74-2"><a href="user-defined-functions.html#cb74-2" tabindex="-1"></a></span>
<span id="cb74-3"><a href="user-defined-functions.html#cb74-3" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Hi my name is&quot;</span>) <span class="co"># will print the string &quot;Hi my name is&quot;</span></span>
<span id="cb74-4"><a href="user-defined-functions.html#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="user-defined-functions.html#cb74-5" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Hi my name is&quot;</span></span>
<span id="cb74-6"><a href="user-defined-functions.html#cb74-6" tabindex="-1"></a></span>
<span id="cb74-7"><a href="user-defined-functions.html#cb74-7" tabindex="-1"></a><span class="co"># Creating our own function</span></span>
<span id="cb74-8"><a href="user-defined-functions.html#cb74-8" tabindex="-1"></a></span>
<span id="cb74-9"><a href="user-defined-functions.html#cb74-9" tabindex="-1"></a><span class="co"># This assigns a function to the name Print_Function</span></span>
<span id="cb74-10"><a href="user-defined-functions.html#cb74-10" tabindex="-1"></a><span class="co"># The function will be performed on all elements in the curly brackets, denoted by the &quot;.&quot; in the function inputs. In actual fact you could put anything in here; it won&#39;t be evaluated.</span></span>
<span id="cb74-11"><a href="user-defined-functions.html#cb74-11" tabindex="-1"></a><span class="co"># The curly brackets open and close the function. The code between is the operation.</span></span>
<span id="cb74-12"><a href="user-defined-functions.html#cb74-12" tabindex="-1"></a></span>
<span id="cb74-13"><a href="user-defined-functions.html#cb74-13" tabindex="-1"></a></span>
<span id="cb74-14"><a href="user-defined-functions.html#cb74-14" tabindex="-1"></a>Print_Function <span class="ot">&lt;-</span> <span class="cf">function</span>(.){ <span class="co"># Define and name the function</span></span>
<span id="cb74-15"><a href="user-defined-functions.html#cb74-15" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Hi my name is&quot;</span>) <span class="co">#give it an operation</span></span>
<span id="cb74-16"><a href="user-defined-functions.html#cb74-16" tabindex="-1"></a>}  <span class="co">#close it</span></span>
<span id="cb74-17"><a href="user-defined-functions.html#cb74-17" tabindex="-1"></a></span>
<span id="cb74-18"><a href="user-defined-functions.html#cb74-18" tabindex="-1"></a><span class="fu">Print_Function</span>() <span class="co"># run the function (with no specified input parameters)</span></span>
<span id="cb74-19"><a href="user-defined-functions.html#cb74-19" tabindex="-1"></a></span>
<span id="cb74-20"><a href="user-defined-functions.html#cb74-20" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Hi my name is&quot;</span></span></code></pre></div>
</div>
<div id="returning-objects" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Returning objects<a href="user-defined-functions.html#returning-objects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Objects created within a function will not be stored in the global environment, unless R is told specifically to do this. This is very useful if you want to create lots of objects temporarily. It does, however, mean you need to know how to extract the relevant objects from your data frame.</p>
<p>The usual <code>&lt;-</code> (assignment) operator will create an object to be used within the function, but this will not be exported to the global environment. The <code>&lt;&lt;-</code> operator will assign the object created to the global environment regardless of where it appears in the function, or whether your function is run to designate a new object. See below for more clarity.</p>
<p>Assigmment function 1 creates 3 variables: a, b and d. I use “d” because <code>c</code> is the combine function itself. We then run the function, which creates the variables but doesn’t assign them to any objects in the global environment.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="user-defined-functions.html#cb75-1" tabindex="-1"></a><span class="co"># create a function, which, within it creates 3 objects: a,b,d</span></span>
<span id="cb75-2"><a href="user-defined-functions.html#cb75-2" tabindex="-1"></a>Assignment_Func_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(.){</span>
<span id="cb75-3"><a href="user-defined-functions.html#cb75-3" tabindex="-1"></a>   a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb75-4"><a href="user-defined-functions.html#cb75-4" tabindex="-1"></a>   b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb75-5"><a href="user-defined-functions.html#cb75-5" tabindex="-1"></a>   d <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb75-6"><a href="user-defined-functions.html#cb75-6" tabindex="-1"></a>}</span>
<span id="cb75-7"><a href="user-defined-functions.html#cb75-7" tabindex="-1"></a><span class="co"># running the function will do nothing</span></span>
<span id="cb75-8"><a href="user-defined-functions.html#cb75-8" tabindex="-1"></a><span class="fu">Assignment_Func_1</span>()</span></code></pre></div>
<p>Assingment function 2 is identical to #1, except that we designate the function to the variable <code>x</code>. This assigns x the value 3 because d was the final object created in the function.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="user-defined-functions.html#cb76-1" tabindex="-1"></a>Assignment_Func_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(.){</span>
<span id="cb76-2"><a href="user-defined-functions.html#cb76-2" tabindex="-1"></a>   a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-3"><a href="user-defined-functions.html#cb76-3" tabindex="-1"></a>   b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb76-4"><a href="user-defined-functions.html#cb76-4" tabindex="-1"></a>   d <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb76-5"><a href="user-defined-functions.html#cb76-5" tabindex="-1"></a>}</span>
<span id="cb76-6"><a href="user-defined-functions.html#cb76-6" tabindex="-1"></a><span class="co"># running the function and assigning it to an object, x</span></span>
<span id="cb76-7"><a href="user-defined-functions.html#cb76-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Assignment_Func_2</span>()</span>
<span id="cb76-8"><a href="user-defined-functions.html#cb76-8" tabindex="-1"></a></span>
<span id="cb76-9"><a href="user-defined-functions.html#cb76-9" tabindex="-1"></a><span class="co"># test what has happened</span></span>
<span id="cb76-10"><a href="user-defined-functions.html#cb76-10" tabindex="-1"></a><span class="fu">print</span>(x)</span>
<span id="cb76-11"><a href="user-defined-functions.html#cb76-11" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">3</span></span></code></pre></div>
<p>To demonstrate that the objects <code>a</code> and <code>b</code> are created within the function, see the iteration 2.1 below. The function still outputs the value of <code>d</code> because it is the last thing created, but we use the prior objects to generate <code>d</code>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="user-defined-functions.html#cb77-1" tabindex="-1"></a>Assignment_Func_2b <span class="ot">&lt;-</span> <span class="cf">function</span>(.){</span>
<span id="cb77-2"><a href="user-defined-functions.html#cb77-2" tabindex="-1"></a>   a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb77-3"><a href="user-defined-functions.html#cb77-3" tabindex="-1"></a>   b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb77-4"><a href="user-defined-functions.html#cb77-4" tabindex="-1"></a>   d <span class="ot">&lt;-</span> a <span class="sc">+</span> b</span>
<span id="cb77-5"><a href="user-defined-functions.html#cb77-5" tabindex="-1"></a>}</span>
<span id="cb77-6"><a href="user-defined-functions.html#cb77-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Assignment_Func_2b</span>()</span>
<span id="cb77-7"><a href="user-defined-functions.html#cb77-7" tabindex="-1"></a></span>
<span id="cb77-8"><a href="user-defined-functions.html#cb77-8" tabindex="-1"></a><span class="fu">print</span>(x)</span>
<span id="cb77-9"><a href="user-defined-functions.html#cb77-9" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">3</span></span></code></pre></div>
<p>If we wanted to specify which object to assign as our output we could use the <code>return()</code> function. Assignment function 3 finishes by returning <code>a</code>, therefore, when we assign the output of the function to our variable, x, it is assigned the value 1 (equivalent to a).</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="user-defined-functions.html#cb78-1" tabindex="-1"></a>Assignment_Func_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(.){</span>
<span id="cb78-2"><a href="user-defined-functions.html#cb78-2" tabindex="-1"></a>   a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb78-3"><a href="user-defined-functions.html#cb78-3" tabindex="-1"></a>   b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb78-4"><a href="user-defined-functions.html#cb78-4" tabindex="-1"></a>   d <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb78-5"><a href="user-defined-functions.html#cb78-5" tabindex="-1"></a>   </span>
<span id="cb78-6"><a href="user-defined-functions.html#cb78-6" tabindex="-1"></a>   <span class="fu">return</span>(a)</span>
<span id="cb78-7"><a href="user-defined-functions.html#cb78-7" tabindex="-1"></a>}</span>
<span id="cb78-8"><a href="user-defined-functions.html#cb78-8" tabindex="-1"></a></span>
<span id="cb78-9"><a href="user-defined-functions.html#cb78-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Assignment_Func_3</span>()</span>
<span id="cb78-10"><a href="user-defined-functions.html#cb78-10" tabindex="-1"></a></span>
<span id="cb78-11"><a href="user-defined-functions.html#cb78-11" tabindex="-1"></a><span class="fu">print</span>(x)</span>
<span id="cb78-12"><a href="user-defined-functions.html#cb78-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>We can also assign objects created within the function using the <code>&lt;&lt;-</code> operator. If you were to run <code>print(a)</code>, <code>print(b)</code> or <code>print(d)</code> in your console at any point so far you would have seen this error: <code>Error in print(b) : object 'b' not found.</code> We can, however, create these objects. Assignment function 4 does this. It creates 2 objects, <code>b</code> and <code>d</code>, in addition to assigning x the value of 1 (because we have returned (a))</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="user-defined-functions.html#cb79-1" tabindex="-1"></a>Assignment_Func_4 <span class="ot">&lt;-</span> <span class="cf">function</span>(.){</span>
<span id="cb79-2"><a href="user-defined-functions.html#cb79-2" tabindex="-1"></a>   a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb79-3"><a href="user-defined-functions.html#cb79-3" tabindex="-1"></a>   b <span class="ot">&lt;&lt;-</span> <span class="dv">2</span></span>
<span id="cb79-4"><a href="user-defined-functions.html#cb79-4" tabindex="-1"></a>   d <span class="ot">&lt;&lt;-</span> <span class="dv">3</span></span>
<span id="cb79-5"><a href="user-defined-functions.html#cb79-5" tabindex="-1"></a>   </span>
<span id="cb79-6"><a href="user-defined-functions.html#cb79-6" tabindex="-1"></a>   <span class="fu">return</span>(a)</span>
<span id="cb79-7"><a href="user-defined-functions.html#cb79-7" tabindex="-1"></a>}</span>
<span id="cb79-8"><a href="user-defined-functions.html#cb79-8" tabindex="-1"></a></span>
<span id="cb79-9"><a href="user-defined-functions.html#cb79-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Assignment_Func_4</span>()</span>
<span id="cb79-10"><a href="user-defined-functions.html#cb79-10" tabindex="-1"></a></span>
<span id="cb79-11"><a href="user-defined-functions.html#cb79-11" tabindex="-1"></a><span class="fu">print</span>(b)</span>
<span id="cb79-12"><a href="user-defined-functions.html#cb79-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span></span>
<span id="cb79-13"><a href="user-defined-functions.html#cb79-13" tabindex="-1"></a></span>
<span id="cb79-14"><a href="user-defined-functions.html#cb79-14" tabindex="-1"></a><span class="fu">print</span>(x)</span>
<span id="cb79-15"><a href="user-defined-functions.html#cb79-15" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
</div>
<div id="passing-objects" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Passing objects<a href="user-defined-functions.html#passing-objects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can pass objects through functions. This helps to generalise ta function’s inputs. Inputs might be objects, vectors, strings, numbers, columns etc.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="user-defined-functions.html#cb80-1" tabindex="-1"></a>Print_Object <span class="ot">&lt;-</span> <span class="cf">function</span>(Input_String){</span>
<span id="cb80-2"><a href="user-defined-functions.html#cb80-2" tabindex="-1"></a>  <span class="fu">print</span>(Input_String)</span>
<span id="cb80-3"><a href="user-defined-functions.html#cb80-3" tabindex="-1"></a>}</span>
<span id="cb80-4"><a href="user-defined-functions.html#cb80-4" tabindex="-1"></a><span class="fu">Print_Object</span>(<span class="at">Input_String =</span> <span class="st">&quot;Hello, is it me you&#39;re looking for&quot;</span>)</span>
<span id="cb80-5"><a href="user-defined-functions.html#cb80-5" tabindex="-1"></a></span>
<span id="cb80-6"><a href="user-defined-functions.html#cb80-6" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Hello, is it me you&#39;re looking for&quot;</span></span></code></pre></div>
<p>When passing more complicated inputs, you might need to know about other operators. The main things to be aware of are <code>{{}}</code>, <code>:=</code> and <code>!!</code>. To do this, we will reload the iris data and play about with generalising our inputs.</p>
<p>You might also need to be careful about how an input is read in: ether as as string (wrapped in speech marks) or an object.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="user-defined-functions.html#cb81-1" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co">#Load dplyr package</span></span>
<span id="cb81-2"><a href="user-defined-functions.html#cb81-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;iris&quot;</span>) <span class="co">#Load the iris data</span></span></code></pre></div>
<div id="creating-the-function" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Creating the function<a href="user-defined-functions.html#creating-the-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="user-defined-functions.html#cb82-1" tabindex="-1"></a><span class="co">#Create an average sepal length table</span></span>
<span id="cb82-2"><a href="user-defined-functions.html#cb82-2" tabindex="-1"></a></span>
<span id="cb82-3"><a href="user-defined-functions.html#cb82-3" tabindex="-1"></a>Summary_Function <span class="ot">&lt;-</span> <span class="cf">function</span>(.){</span>
<span id="cb82-4"><a href="user-defined-functions.html#cb82-4" tabindex="-1"></a>   </span>
<span id="cb82-5"><a href="user-defined-functions.html#cb82-5" tabindex="-1"></a>   Summary_Table <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb82-6"><a href="user-defined-functions.html#cb82-6" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="user-defined-functions.html#cb82-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Sepal_Length =</span> <span class="fu">mean</span>(Sepal.Length))</span>
<span id="cb82-8"><a href="user-defined-functions.html#cb82-8" tabindex="-1"></a></span>
<span id="cb82-9"><a href="user-defined-functions.html#cb82-9" tabindex="-1"></a>}</span>
<span id="cb82-10"><a href="user-defined-functions.html#cb82-10" tabindex="-1"></a></span>
<span id="cb82-11"><a href="user-defined-functions.html#cb82-11" tabindex="-1"></a>Av_Sepal_Length_Table <span class="ot">&lt;-</span> <span class="fu">Summary_Function</span>()</span>
<span id="cb82-12"><a href="user-defined-functions.html#cb82-12" tabindex="-1"></a><span class="fu">print</span>(Av_Sepal_Length_Table)</span>
<span id="cb82-13"><a href="user-defined-functions.html#cb82-13" tabindex="-1"></a></span>
<span id="cb82-14"><a href="user-defined-functions.html#cb82-14" tabindex="-1"></a><span class="co"># # A tibble: 3 x 2</span></span>
<span id="cb82-15"><a href="user-defined-functions.html#cb82-15" tabindex="-1"></a><span class="co">#   Species    Average_Sepal_Length</span></span>
<span id="cb82-16"><a href="user-defined-functions.html#cb82-16" tabindex="-1"></a><span class="co"># 1 setosa                     5.01</span></span>
<span id="cb82-17"><a href="user-defined-functions.html#cb82-17" tabindex="-1"></a><span class="co"># 2 versicolor                 5.94</span></span>
<span id="cb82-18"><a href="user-defined-functions.html#cb82-18" tabindex="-1"></a><span class="co"># 3 virginica                  6.59</span></span></code></pre></div>
</div>
<div id="passing-data" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Passing data<a href="user-defined-functions.html#passing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="user-defined-functions.html#cb83-1" tabindex="-1"></a><span class="co">#Create an average sepal length table</span></span>
<span id="cb83-2"><a href="user-defined-functions.html#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="user-defined-functions.html#cb83-3" tabindex="-1"></a>Summary_Function <span class="ot">&lt;-</span> <span class="cf">function</span>(DATA_FRAME){</span>
<span id="cb83-4"><a href="user-defined-functions.html#cb83-4" tabindex="-1"></a>   </span>
<span id="cb83-5"><a href="user-defined-functions.html#cb83-5" tabindex="-1"></a>   Summary_Table <span class="ot">&lt;-</span> DATA_FRAME <span class="sc">%&gt;%</span></span>
<span id="cb83-6"><a href="user-defined-functions.html#cb83-6" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb83-7"><a href="user-defined-functions.html#cb83-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Sepal_Length =</span> <span class="fu">mean</span>(Sepal.Length))</span>
<span id="cb83-8"><a href="user-defined-functions.html#cb83-8" tabindex="-1"></a></span>
<span id="cb83-9"><a href="user-defined-functions.html#cb83-9" tabindex="-1"></a>}</span>
<span id="cb83-10"><a href="user-defined-functions.html#cb83-10" tabindex="-1"></a></span>
<span id="cb83-11"><a href="user-defined-functions.html#cb83-11" tabindex="-1"></a>Av_Sepal_Length_Table <span class="ot">&lt;-</span> <span class="fu">Summary_Function</span>(<span class="at">DATA_FRAME =</span> iris)</span>
<span id="cb83-12"><a href="user-defined-functions.html#cb83-12" tabindex="-1"></a><span class="fu">print</span>(Av_Sepal_Length_Table)</span>
<span id="cb83-13"><a href="user-defined-functions.html#cb83-13" tabindex="-1"></a></span>
<span id="cb83-14"><a href="user-defined-functions.html#cb83-14" tabindex="-1"></a><span class="co"># # A tibble: 3 x 2</span></span>
<span id="cb83-15"><a href="user-defined-functions.html#cb83-15" tabindex="-1"></a><span class="co">#   Species    Average_Sepal_Length</span></span>
<span id="cb83-16"><a href="user-defined-functions.html#cb83-16" tabindex="-1"></a><span class="co"># 1 setosa                     5.01</span></span>
<span id="cb83-17"><a href="user-defined-functions.html#cb83-17" tabindex="-1"></a><span class="co"># 2 versicolor                 5.94</span></span>
<span id="cb83-18"><a href="user-defined-functions.html#cb83-18" tabindex="-1"></a><span class="co"># 3 virginica                  6.59</span></span></code></pre></div>
<p>Now, as we try to involve more complex arguments, we need to tell R more about the objects we are passing through it. Different functions work in different ways. The <code>group_by()</code> and <code>summarise()</code> functions look for the variables as quoted arguments. In order to tell R that the object being passed is in fact a variable name, we need to use <code>{{}}</code> (curly-curly).</p>
<p>Also, note that we’ve had to use <code>:=</code> (colon equals) instead of <code>=</code>. This will also be true for <code>mutate()</code> functions when you mutate columns by having passed the column name through the function. It allows you to perform assignments by reference.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="user-defined-functions.html#cb84-1" tabindex="-1"></a><span class="co">#Create an average sepal length table</span></span>
<span id="cb84-2"><a href="user-defined-functions.html#cb84-2" tabindex="-1"></a></span>
<span id="cb84-3"><a href="user-defined-functions.html#cb84-3" tabindex="-1"></a>Summary_Function <span class="ot">&lt;-</span> <span class="cf">function</span>(DATA_FRAME, GROUP_BY_COL, SUMMARY_COL){</span>
<span id="cb84-4"><a href="user-defined-functions.html#cb84-4" tabindex="-1"></a>   </span>
<span id="cb84-5"><a href="user-defined-functions.html#cb84-5" tabindex="-1"></a>   Summary_Table <span class="ot">&lt;-</span> DATA_FRAME <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="user-defined-functions.html#cb84-6" tabindex="-1"></a>  <span class="fu">group_by</span>({{GROUP_BY_COL}}) <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="user-defined-functions.html#cb84-7" tabindex="-1"></a>  <span class="fu">summarise</span>({{SUMMARY_COL}} <span class="sc">:=</span> <span class="fu">mean</span>(Sepal.Length))</span>
<span id="cb84-8"><a href="user-defined-functions.html#cb84-8" tabindex="-1"></a></span>
<span id="cb84-9"><a href="user-defined-functions.html#cb84-9" tabindex="-1"></a>}</span>
<span id="cb84-10"><a href="user-defined-functions.html#cb84-10" tabindex="-1"></a></span>
<span id="cb84-11"><a href="user-defined-functions.html#cb84-11" tabindex="-1"></a>Av_Sepal_Length_Table <span class="ot">&lt;-</span> <span class="fu">Summary_Function</span>(<span class="at">DATA_FRAME =</span> iris,</span>
<span id="cb84-12"><a href="user-defined-functions.html#cb84-12" tabindex="-1"></a>                                          <span class="at">GROUP_BY_COL =</span> Species,</span>
<span id="cb84-13"><a href="user-defined-functions.html#cb84-13" tabindex="-1"></a>                                          <span class="at">SUMMARY_COL =</span> Average_Sepal_Length)</span>
<span id="cb84-14"><a href="user-defined-functions.html#cb84-14" tabindex="-1"></a><span class="fu">print</span>(Av_Sepal_Length_Table)</span>
<span id="cb84-15"><a href="user-defined-functions.html#cb84-15" tabindex="-1"></a></span>
<span id="cb84-16"><a href="user-defined-functions.html#cb84-16" tabindex="-1"></a><span class="co"># # A tibble: 3 x 2</span></span>
<span id="cb84-17"><a href="user-defined-functions.html#cb84-17" tabindex="-1"></a><span class="co">#   Species    Average_Sepal_Length</span></span>
<span id="cb84-18"><a href="user-defined-functions.html#cb84-18" tabindex="-1"></a><span class="co"># 1 setosa                     5.01</span></span>
<span id="cb84-19"><a href="user-defined-functions.html#cb84-19" tabindex="-1"></a><span class="co"># 2 versicolor                 5.94</span></span>
<span id="cb84-20"><a href="user-defined-functions.html#cb84-20" tabindex="-1"></a><span class="co"># 3 virginica                  6.59</span></span></code></pre></div>
<p>Finally, it might be that you need your inputs to change between quoted and unquoted arguments. In the example below, given the nature of the vector, these elements need to be in quotations. But when we call them in our dplyr chain, we want R to recognise them as objects. We use as.name, a base R fuction that takes a string (or a variable containing a string) and returns the content of the string as a variable name. The <code>!!</code> (bang-bang) tells the summarise function to not take the value as it is, but to substitute the real value.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="user-defined-functions.html#cb85-1" tabindex="-1"></a><span class="co">#Create an average sepal length table</span></span>
<span id="cb85-2"><a href="user-defined-functions.html#cb85-2" tabindex="-1"></a></span>
<span id="cb85-3"><a href="user-defined-functions.html#cb85-3" tabindex="-1"></a>Summary_Function <span class="ot">&lt;-</span> <span class="cf">function</span>(Col_Vector,</span>
<span id="cb85-4"><a href="user-defined-functions.html#cb85-4" tabindex="-1"></a>                             i){</span>
<span id="cb85-5"><a href="user-defined-functions.html#cb85-5" tabindex="-1"></a>   </span>
<span id="cb85-6"><a href="user-defined-functions.html#cb85-6" tabindex="-1"></a>   <span class="co">#depending on the value of i, this will extract the element in position i of the Col_Vector. It assigns the string to an element, Col_Averaging</span></span>
<span id="cb85-7"><a href="user-defined-functions.html#cb85-7" tabindex="-1"></a>   Col_Averaging <span class="ot">&lt;-</span> Col_Vector[i]</span>
<span id="cb85-8"><a href="user-defined-functions.html#cb85-8" tabindex="-1"></a>   </span>
<span id="cb85-9"><a href="user-defined-functions.html#cb85-9" tabindex="-1"></a>   Summary_Table <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb85-10"><a href="user-defined-functions.html#cb85-10" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb85-11"><a href="user-defined-functions.html#cb85-11" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="sc">!!</span><span class="fu">as.name</span>(<span class="fu">paste0</span>(<span class="st">&quot;Average_&quot;</span>, Col_Averaging))  <span class="sc">:=</span> <span class="fu">mean</span>(<span class="sc">!!</span><span class="fu">as.name</span>(Col_Averaging))) <span class="co">#the paste0 is to generalise the column title as a concatenaetion of Average and the Column we select. </span></span>
<span id="cb85-12"><a href="user-defined-functions.html#cb85-12" tabindex="-1"></a></span>
<span id="cb85-13"><a href="user-defined-functions.html#cb85-13" tabindex="-1"></a>}</span>
<span id="cb85-14"><a href="user-defined-functions.html#cb85-14" tabindex="-1"></a></span>
<span id="cb85-15"><a href="user-defined-functions.html#cb85-15" tabindex="-1"></a>Av_Table <span class="ot">&lt;-</span> <span class="fu">Summary_Function</span>(<span class="at">Col_Vector =</span> <span class="fu">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Sepal.Width&quot;</span>,  <span class="st">&quot;Petal.Length&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>),</span>
<span id="cb85-16"><a href="user-defined-functions.html#cb85-16" tabindex="-1"></a>                                          <span class="at">i =</span> <span class="dv">2</span>)</span>
<span id="cb85-17"><a href="user-defined-functions.html#cb85-17" tabindex="-1"></a><span class="fu">print</span>(Av_Table)</span>
<span id="cb85-18"><a href="user-defined-functions.html#cb85-18" tabindex="-1"></a></span>
<span id="cb85-19"><a href="user-defined-functions.html#cb85-19" tabindex="-1"></a><span class="co"># A tibble: 3 x 2</span></span>
<span id="cb85-20"><a href="user-defined-functions.html#cb85-20" tabindex="-1"></a><span class="co">#   Species    Average_Sepal.Width</span></span>
<span id="cb85-21"><a href="user-defined-functions.html#cb85-21" tabindex="-1"></a><span class="co"># 1 setosa                    3.43</span></span>
<span id="cb85-22"><a href="user-defined-functions.html#cb85-22" tabindex="-1"></a><span class="co"># 2 versicolor                2.77</span></span>
<span id="cb85-23"><a href="user-defined-functions.html#cb85-23" tabindex="-1"></a><span class="co"># 3 virginica                 2.97</span></span></code></pre></div>
</div>
</div>
<div id="setting-default-inputs" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Setting default inputs<a href="user-defined-functions.html#setting-default-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can tell a function that if an input is not specified otherwise, to autofill that argument with something pre-determined.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="user-defined-functions.html#cb86-1" tabindex="-1"></a>My_Print_Function <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Input_String =</span> <span class="st">&quot;The assigned default input&quot;</span>){</span>
<span id="cb86-2"><a href="user-defined-functions.html#cb86-2" tabindex="-1"></a>   </span>
<span id="cb86-3"><a href="user-defined-functions.html#cb86-3" tabindex="-1"></a>   <span class="fu">print</span>(Input_String)</span>
<span id="cb86-4"><a href="user-defined-functions.html#cb86-4" tabindex="-1"></a>}</span>
<span id="cb86-5"><a href="user-defined-functions.html#cb86-5" tabindex="-1"></a></span>
<span id="cb86-6"><a href="user-defined-functions.html#cb86-6" tabindex="-1"></a><span class="fu">My_Print_Function</span>()</span>
<span id="cb86-7"><a href="user-defined-functions.html#cb86-7" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;The assigned default input&quot;</span></span>
<span id="cb86-8"><a href="user-defined-functions.html#cb86-8" tabindex="-1"></a></span>
<span id="cb86-9"><a href="user-defined-functions.html#cb86-9" tabindex="-1"></a><span class="fu">My_Print_Function</span>(<span class="st">&quot;Print this instead&quot;</span>)</span>
<span id="cb86-10"><a href="user-defined-functions.html#cb86-10" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;print this instead&quot;</span></span></code></pre></div>
<p>Another key for setting defaults is ensuring that your function can work both on its own and within dplyr pipes. You can often get away with setting one of the function arguments to be “data_frame”. If you are in a dplyr pipe, you will not need to manually specify this argument because R will just assign the first element you’re working with to be a data frame.</p>
<p>If you want to be able to call the data_frame object and interact with it, then you should tell R this. Setting the argument: <code>data_frame = .data</code> will allow you to do this. In this way, if you are working outside a dplyr pipe, you can reassign the object such that data_frame = insert_name_of_your_data . Alternatively, if you are in a pipe, you will be able to use the data_frame object within the function.</p>
</div>
<div id="Loops" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Using Loops<a href="user-defined-functions.html#Loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Loops are often more computationally intensive than functions from the <code>apply()</code> family. See this <a href="https://towardsdatascience.com/dealing-with-apply-functions-in-r-ea99d3f49a71">guidance</a> for usage details. it can be harder to get your head around.</p>
<p>Loops increase the power (and running time) of functions . They allow you to specify the array sets on which to apply functions. The two most used loop functions are <code>for()</code> and <code>while()</code>. Generally, <code>for()</code> loops are easier to use, unless the condition changes as the function evolves. In the most basic sense, these formulae do the same thing:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="user-defined-functions.html#cb87-1" tabindex="-1"></a><span class="co"># 1.</span></span>
<span id="cb87-2"><a href="user-defined-functions.html#cb87-2" tabindex="-1"></a></span>
<span id="cb87-3"><a href="user-defined-functions.html#cb87-3" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-4"><a href="user-defined-functions.html#cb87-4" tabindex="-1"></a><span class="cf">while</span>(i <span class="sc">&lt;</span> <span class="dv">4</span>){</span>
<span id="cb87-5"><a href="user-defined-functions.html#cb87-5" tabindex="-1"></a>   <span class="fu">print</span>(i)</span>
<span id="cb87-6"><a href="user-defined-functions.html#cb87-6" tabindex="-1"></a>   i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb87-7"><a href="user-defined-functions.html#cb87-7" tabindex="-1"></a>}</span>
<span id="cb87-8"><a href="user-defined-functions.html#cb87-8" tabindex="-1"></a></span>
<span id="cb87-9"><a href="user-defined-functions.html#cb87-9" tabindex="-1"></a><span class="co">#2. </span></span>
<span id="cb87-10"><a href="user-defined-functions.html#cb87-10" tabindex="-1"></a></span>
<span id="cb87-11"><a href="user-defined-functions.html#cb87-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb87-12"><a href="user-defined-functions.html#cb87-12" tabindex="-1"></a>   <span class="fu">print</span>(i)</span>
<span id="cb87-13"><a href="user-defined-functions.html#cb87-13" tabindex="-1"></a>}</span></code></pre></div>
<p>While loops are useful when we don’t know exactly when to terminate the loop. They do, however, require us to define an evolving condition. More common is to know the set around which we need to loop. This will usually be a number or vector (remember vectors can vary in length). E.g., you could run a loop around <code>i in 1:length(vector)</code></p>
<p>You can apply vectors over multiple objects using the <code>apply()</code> family of functions: <code>tapply()</code>, <code>sapply()</code>, <code>lapply()</code>. You can also achieve this with loops</p>
<p>The function <code>get()</code> can be used to turn a text string into an object (similar to !! and {{}}). It is more flexible.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="user-defined-functions.html#cb88-1" tabindex="-1"></a><span class="co"># deinfe a vector of the data frame names</span></span>
<span id="cb88-2"><a href="user-defined-functions.html#cb88-2" tabindex="-1"></a>df_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(“df1”, “df2”, “df3)</span>
<span id="cb88-3"><a href="user-defined-functions.html#cb88-3" tabindex="-1"></a> </span>
<span id="cb88-4"><a href="user-defined-functions.html#cb88-4" tabindex="-1"></a><span class="co"># loop around the vector you&#39;ve defined</span></span>
<span id="cb88-5"><a href="user-defined-functions.html#cb88-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> df_vector){</span>
<span id="cb88-6"><a href="user-defined-functions.html#cb88-6" tabindex="-1"></a> </span>
<span id="cb88-7"><a href="user-defined-functions.html#cb88-7" tabindex="-1"></a><span class="co"># assign an object, df, to be the object i </span></span>
<span id="cb88-8"><a href="user-defined-functions.html#cb88-8" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">get</span>(i) <span class="sc">%&gt;%</span></span>
<span id="cb88-9"><a href="user-defined-functions.html#cb88-9" tabindex="-1"></a>  <span class="co"># transform object</span></span>
<span id="cb88-10"><a href="user-defined-functions.html#cb88-10" tabindex="-1"></a><span class="fu">mutate</span>(sdaiusfd)</span>
<span id="cb88-11"><a href="user-defined-functions.html#cb88-11" tabindex="-1"></a> </span>
<span id="cb88-12"><a href="user-defined-functions.html#cb88-12" tabindex="-1"></a><span class="co"># reassign the object in the global environment with the same name as i to be the df we&#39;ve just manipulated</span></span>
<span id="cb88-13"><a href="user-defined-functions.html#cb88-13" tabindex="-1"></a><span class="co"># you could change the name of i with paste0() if you wanted</span></span>
<span id="cb88-14"><a href="user-defined-functions.html#cb88-14" tabindex="-1"></a><span class="fu">assign</span>(i, df)</span>
<span id="cb88-15"><a href="user-defined-functions.html#cb88-15" tabindex="-1"></a> </span>
<span id="cb88-16"><a href="user-defined-functions.html#cb88-16" tabindex="-1"></a>}</span>
<span id="cb88-17"><a href="user-defined-functions.html#cb88-17" tabindex="-1"></a><span class="co"># remove elements used in loop</span></span>
<span id="cb88-18"><a href="user-defined-functions.html#cb88-18" tabindex="-1"></a><span class="fu">rm</span>(i, df)</span></code></pre></div>
</div>
<div id="random-snippets" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Random snippets<a href="user-defined-functions.html#random-snippets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Assign a variable out of a loop so that the outputs have different names</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="user-defined-functions.html#cb89-1" tabindex="-1"></a><span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">&quot;output_name_start_&quot;</span>, year_suffix), df, <span class="at">inherits =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Evaluate a name as a text string with <code>deparse(substitute(name))</code></p>
<p>Create a blank tibble with names from a vecotr, <code>cols_vector</code>. You can use this to bind rows to the bottom of.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="user-defined-functions.html#cb90-1" tabindex="-1"></a>blank_df <span class="ot">&lt;-</span> cols_vector <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map_dfc</span>(<span class="sc">~</span>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="sc">!!</span><span class="at">.x :=</span> <span class="fu">logical</span>()))</span></code></pre></div>
<p>For more examples or applications, feel free to contact me: <a href="mailto:thomas.harris@education.gov.uk" class="email">thomas.harris@education.gov.uk</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tomambroseharris/HE_R_Training/edit/master/07-User_Defined_Functions.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/tomambroseharris/HE_R_Training/blob/master/07-User_Defined_Functions.rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
